<!doctype html>
<html lang="bg">

<head>
  <meta charset="utf-8">

  <title>Често неосъзнати проблеми и решения</title>

  <meta name="description" content="Презентация за неосъзнати проблеми и решения в С++ програмирането (алфа версия)">
  <meta name="author" content="Борислав Станимиров">

  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <link rel="stylesheet" href="../lib/reveal.js-3.8.0/css/reveal.min.css" />
  <link rel="stylesheet" href="../lib/reveal.js-3.8.0/css/theme/simple.min.css" id="theme" />
  <link rel="stylesheet" href="../lib/slides.css" />

  <!-- For syntax highlighting -->
  <link rel="stylesheet" href="/third_party/highlight-new/styles/github-gist.css">

  <!-- Slides-specific styles -->
  <link rel="stylesheet" href="custom.css">

  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ?
      'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/css/print/pdf.min.css' :
      'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/css/print/paper.min.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>

  <!--[if lt IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/lib/js/html5shiv.js"></script>
  <![endif]-->
</head>

<body>

  <div class="reveal">
    <div class="slides">
      <section class="title">
        <h1>Често неосъзнати проблеми и решения</h1>
        <br/>
        <p>
          <a href="http://ibob.github.io">Борислав Станимиров</a> / <a href="https://twitter.com/stanimirovb">@stanimirovb</a>
        </p>
      </section>

      <section class="slide">
        <h3>Hello, World</h3>
        <br/>
        <pre><code class="cpp hljs" data-noescape>
  #include &lt;iostream&gt;

  int main()
  {
      std::cout &lt;&lt; "Здравейте, аз съм Борислав!\n";
      std::cout &lt;&lt; "Тези слайдове са тук: <span class="fragment hl-code">https://is.gd/unrealizedv1</span>\n";
      return 0;
  }
        </code></pre>
      </section>

      <section class="slide">
        <h3>Борислав Станимиров</h3>
        <br/>
        <ul>
          <li>Предимно <span class="fancy">C++</span> програмист</li>
          <li>2006-2018 програмист на <span class="fancy">игри</span></li>
          <li>От 2019 <span class="fancy">медицински софтуер</span></li>
          <li>Софтуер с <span class="fancy">отворен код</span></li>
          <li><a href="https://github.com/iboB" target="_blank">github.com/iboB</a></li>
        </ul>
      </section>

      <section>
        <img class="diagram" src="ViewRay_Logo.png"/>
        <br><br>
        <p>Вижте как третираме рак на <a href="https://viewray.com" target="_blank">viewray.com</a></p>
      </section>

      <section class="slide">
        <h3>Характеристики на софтуерен проект</h3>
        <br/>
        <ul>
          <li>Коректност</li>
          <li>Производителност</li>
          <li>Ефективност на разработка</li>
        </ul>
        <p>... и още</p>
        <ul>
          <li>Сигурност</li>
          <li>Дизайн</li>
          <li>UX</li>
          <li>...</li>
        </ul>
      </section>

      <section class="slide">
        <h3>Характеристики на софтуерен проект</h3>
        <br/>
        <ul>
          <li><span class="fancy">Коректност</span></li>
          <li><span class="fancy">Производителност</span></li>
          <li><span class="fancy">Ефективност на разработка</span></li>
        </ul>
      </section>

      <section>
        <p>Аналогията с мениджърския триъгълник е възможна</p>
        <img class="diagram" src="pick-two.gif" />
      </section>

      <section>
        <h3>Проблеми</h3>
      </section>

      <section>
        <h3>Коректност: <span class="fancy">бъгове</span></h3>
        <img class="diagram" src="calc-bug.png" />
      </section>

      <section>
        <h3>Производителност: <span class="fancy">бавности</span></h3>
        <img class="diagram" src="sleeping.jpg" />
      </section>

      <section>
        <p>Ефективност на разработка: <span class="fancy">некачествен код</span></p>
        <img class="diagram" src="moms-spaghetti.jpg" />
      </section>

      <section>
        <h3>Мета-проблеми</h3>
        <img class="diagram" src="dilbert.jpeg" />
        <p>няма да се занимаваме с тях</p>
      </section>

      <section>
        <p>Често имаме от всичко по малко</p>
        <p>&#x1f61e;</p>
      </section>

      <section>
        <h3>Осъзнати проблеми</h3>
        <p>Имаме избор</p>
      </section>

      <section>
        <h3>Да ги решаваме</h3>
        <img class="diagram" src="excavator.jpg" />
      </section>

      <section>
        <p>... което не винаги е възможно или практично</p>
        <img class="diagram" src="evergreen-digger.jpg" />
      </section>

      <section>
        <h3>Да ги оставим съзнателно</h3>
        <img class="diagram" src="bug-feature.jpg" />
      </section>

      <section>
        <h3>Неосъзнати проблеми</h3>
      </section>

      <section class="slide">
        <h3>Тази презентация</h3>
        <br/>
        <ul>
          <li>Няколко често неосъзнати проблема</li>
          <li><span class="fancy">Arms race</span> в неосъзнатите проблеми и презентациите</li>
          <li><em>Когато един проблем се окаже често неосъзнат, започва да се говори повече за него и той става <span class="fancy">често осъзнат</span></em></li>
          <li>Може би има до болка известни неща</li>
          <li>Може би има неща, които никой не среща</li>
          <li>...по-скоро първото</li>
        </ul>
      </section>

      <section>
        <img class="diagram" src="jesus.jpg" />
        <p>But that's just, like, my opinion, man</p>
      </section>

      <section class="slide">
        <h3>Неосъзнати бъгове</h3>
        <br/>
        <ul>
          <li>Най-често срещаният проблем</li>
          <li>Има безкрайно много материали по темата</li>
          <ul>
            <li>Unit tests</li>
            <li>Integration tests</li>
            <li>TDD</li>
            <li>...</li>
          </ul>
          <li>Няма да се занимаваме с тях</li>
        </ul>
      </section>

      <section class="slide">
        <h3>Неосъзнати бавности</h3>
        <br/>
        <ul>
          <li>Водещата подтема</li>
          <li>C++ е перфектната среда за тях</li>
          <li>Езикът може да <span class="fancy">крие много</span></li>
          <li>Често <span class="fancy">бързодействието е водещо</span></li>
        </ul>
      </section>

      <section class="slide">
        <h3>Неосъзнат лош код</h3>
        <br/>
        <ul>
          <li>По-често <span class="fancy">„непризнат“</span> отколкото неосъзнат</li>
          <ul>
            <li>Design patterns</li>
            <li>Clean code, SOLID</li>
            <li>Modern C++</li>
            <li>Build times</li>
            <li>Build systems</li>
            <li>Package managers</li>
          </ul>
          <li>Няколко дребни трика</li>
        </ul>
      </section>

      <section>
        <h3>Неволно копиране</h3>
      </section>

      <section>
        <pre><code class="cpp hljs" data-noescape>
  class big_obj {
  public:
    big_obj();
    big_obj(const big_obj&amp;);
    big_obj&amp; operator=(const big_obj&amp;);
    big_obj(big_obj&amp;&amp;);
    big_obj&amp; operator=(big_obj&amp;&amp;);
  private:
    big_data m_data;
  };
  // ...
  std::vector&lt;big_obj&gt; objects;
  // ...
  objects.push_back(std::move(new_object));
        </code></pre>
        <p>Какъв е проблемът тук?</p>
      </section>

      <section>
        <p><code class="cinline">std::vector</code> използва <code class="cinline">std::move_if_noexcept</code></p>
      </section>

      <section>
        <pre><code class="cpp hljs" data-noescape>
  class big_obj {
  public:
    big_obj();
    big_obj(const big_obj&amp;);
    big_obj&amp; operator=(const big_obj&amp;);
    big_obj(big_obj&amp;&amp;) <span class="fragment hl-code-i">noexcept;</span>
    big_obj&amp; operator=(big_obj&amp;&amp;) <span class="fragment hl-code-i">noexcept;</span>
  private:
    big_data m_data;
  };
  // ...
  std::vector&lt;big_obj&gt; objects;
  // ...
  <span class="hl-code-i">objects.push_back(std::move(new_object));</span>
        </code></pre>
        <p><a class="fragment" href="https://github.com/iboB/unrealized-problems-demo/blob/master/00-copy-over-move.cpp" target="_blank">Демо</a></p>
      </section>

      <section>
        <p>Една история със <code class="cinline">std::function</code></p>
      </section>

      <section>
        <pre><code class="cpp hljs" data-noescape>
  struct simple_struct {
      std::function&lt;void(int)&gt; func;
      std::vector&lt;int&gt; data; // call func with each element in data
  };
  //...
  std::vector<simple_struct> stuffs;</code></pre>
        <ul>
          <li>Дотук всичко си работи</li>
          <li>Дебъгвам си нещо несвързано и изведнъж съм във <code class="cinline">vector::vector(const vector&amp;)</code></li>
        </ul>
        <p>&#x1f632</p>
      </section>

      <section class="slide">
        <h3><code>std::function</code></h3>
        <p style="text-align: center;"><img class="diagram" src="func-func.png" /></p>
        <ul>
          <li>До C++20 <span class="fancy">не е</span> задължително noexcept-move</li>
          <li>Small-function optimization</li>
          <ul>
            <li>Без алокации за малки функции</li>
            <li>Move трябва да премести и всички captures</li>
            <li>... които може да не са noexcept-move</li>
          </ul>
          <li>В <span class="fancy">нови версии</span> на libc++ и libstdc++ работи и със C++11</li>
          <ul>
            <li>Ползваме буфера, само ако можем да местим с noexcept</li>
          </ul>
          <li><a href="https://github.com/iboB/unrealized-problems-demo/blob/master/01-func-move-noexcept-false.cpp" target="_blank">Демо</a></li>
        </ul>
      </section>

      <section>
        <h3><code>ufunction</code></h3>
      </section>

      <section class="slide">
        <h3><code>itlib::ufunction</code></h3>
        <br/>
        <ul>
          <li><a href="https://github.com/iboB/itlib/blob/master/include/itlib/ufunction.hpp" target="_blank">gh/iboB/itlib/ufunction.hpp</a></li>
          <li>Вероятно съществуват и други имплементации</li>
          <li>Тънка опаковка на <code class="cinline">std::function</code></li>
          <li>Unique Function</li>
          <ul>
            <li><span class="fancy">noexcept move constructible</span></li>
            <li><span class="fancy">non-copyable</span></li>
          </ul>
          <li>... от което произлезе бонус: <span class="fancy">capture non-copyable data</span></li>
        </ul>
      </section>

      <section>
        <pre><code class="cpp hljs" data-noescape>
          auto pfoo = std::make_unique&lt;foo&gt;
          <span class="fragment">itlib::ufunction&lt;void()&gt; func = [<span class="fragment hl-code">p = std::move(pfoo)</span>]() <span class="fragment hl-code">mutable</span> {
            // ...
            <span class="fragment hl-code">consumer.consume(std::move(pfoo));</span>
          }</span>
          <span class="fragment">push_task(func)</span>
        </code></pre>
        <p><a href="https://github.com/iboB/unrealized-problems-demo/blob/master/02-capture-non-copy.cpp" target="_blank">Демо</a></p>
        <p>Според мен в почти всички случаи <code class="cinline">std::function</code></p>
        <p><span class="fancy">може да бъде заменена</span> с <code class="cinline">ufunction</code></p>
      </section>

      <section>
        <code>small_vector</code>
      </section>

      <section>
        <code>std::array</code>
        <code>std::static_vector</code>
      </section>

      <section>
        <code>pod_vector</code>
      </section>

      <section>
        <code>flat_map, flat_set</code>
      </section>

      <section>
        <code>span, memory_view</code>
      </section>

      <section>
        Itlib
        <code>sentry</code>
        <code>mscharconv</code>
        <code>cpm</code>
      </section>

      <section>
        <h1>Край</h1>
        <h2>Въпроси?</h2>
        <p>Борислав Станимиров / <a href="https://ibob.github.io">ibob.github.io</a> / <a href="https://twitter.com/stanimirovb">@stanimirovb</a></p>
        <p>
          <small>
          Тези слайдове: <a href="https://ibob.github.io/slides/unrealized-alpha/">ibob.github.io/slides/unrealized-alpha/</a>
          </small>
          <br />
          <small>
          Лиценз на слайдовете <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons By 4.0</a><br /><a rel="license" href="https://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/4.0/88x31.png" /></a>
          </small>
        </p>
      </section>

    </div>
  </div>

  <script src="../lib/reveal.js-3.8.0/js/reveal.min.js"></script>
  <script src="../lib/slides.js"></script>

  <script>
    Reveal.initialize({
      width: 1280,
      height: 720,

      controls: true,
      progress: true,
      history: true,
      center: true,

      transition: 'none', // none/fade/slide/convex/concave/zoom

      autoPlayMedia: false,
      preloadIframes: false,

      // Optional libraries used to extend on reveal.js
      dependencies: [
        //{ src: 'markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        //{ src: 'markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: 'highlight/highlight.min.js', async: true, callback: function() {
          hljs.initHighlightingOnLoad();
        } },
        //{ src: 'zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
        //{ src: 'notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
      ].map(p => { p.src = '../lib/reveal.js-3.8.0/plugin/' + p.src; return p; })
    });

    slides.footerSetup('https://is.gd/unrealizedv1', '2022');
  </script>

</body>
</html>
